<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°å­¦ç”Ÿäº¤æµè¯„å®šé‡è¡¨</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="config.js"></script>

    <style>
        /* åŸºç¡€æ ·å¼é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            /* æ ‡å‡†è¯­æ³• */
        }

        body {
            font-family: 'Nunito', sans-serif;
            line-height: 1.6;
            color: #374151;
            /* æ·±ç°è‰²æ–‡æœ¬ */
            background-color: #F9FAFB;
            padding: 20px;
        }

        /* å®¹å™¨æ ·å¼ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.03);
            overflow: hidden;
            padding: 30px;
            animation: fadeIn 0.8s ease-in-out;
        }

        /* æ ‡é¢˜æ ·å¼ */
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #6D28D9;
            /* æ·±ç´«è‰² */
            font-size: 2.5rem;
            font-weight: 700;
            padding-bottom: 15px;
            border-bottom: 2px solid #EDE9FE;
            /* æµ…ç´«è‰² */
        }

        /* æè¿°æ–‡æœ¬æ ·å¼ */
        .scale-description {
            margin-bottom: 25px;
            font-weight: 600;
            font-size: 1.1rem;
            padding: 15px;
            background-color: #EDE9FE;
            border-radius: 10px;
            color: #6D28D9;
        }

        /* ä¿¡æ¯å¡«å†™åŒºåŸŸ */
        .info-section {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 25px 0;
        }

        .info-item {
            flex: 1;
            min-width: 250px;
            position: relative;
            /* ä¸ºå›¾æ ‡å®šä½ */
        }

        .info-item .icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(+50%);
            color: #9CA3AF;
            transition: color 0.3s ease;
        }

        .info-item label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4B5563;
        }

        .info-item input {
            width: 100%;
            padding: 12px 15px 12px 40px;
            /* ä¸ºå›¾æ ‡ç•™å‡ºç©ºé—´ */
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .info-item input:focus {
            outline: none;
            border-color: #8B5CF6;
            /* ä¸­ç´«è‰² */
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .info-item input:focus+.icon {
            color: #8B5CF6;
        }

        /* è¯´æ˜æ–‡å­— */
        .instructions {
            margin: 25px 0;
            padding: 15px;
            background-color: #F3F4F6;
            border-radius: 10px;
            font-size: 1rem;
        }

        .instructions p {
            margin-bottom: 10px;
        }

        .instructions p:last-child {
            margin-bottom: 0;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .assessment-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-bottom: 30px;

        }

        .assessment-table th,
        .assessment-table td {
            padding: 15px 10px;
            text-align: center;
            border-bottom: 1px solid #E5E7EB;
            position: relative;
            vertical-align: middle;
        }

        .assessment-table th {
            background: linear-gradient(135deg, #8B5CF6, #6D28D9);
            color: white;
            font-weight: 600;
            font-size: 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .assessment-table tr:last-child td {
            border-bottom: none;
        }

        .assessment-table tbody tr:hover {
            background-color: #F9FAFB;
        }

        /* ä¿®å¤ sticky header çš„åœ†è§’é—®é¢˜ */
        .table-wrapper {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }

        .question-number {
            font-weight: 700;
            color: #6D28D9;
            width: 60px;
        }

        .question-description {
            text-align: left;
            padding-left: 20px;
            width: 40%;
        }

        /* å®Œæˆé¡µé¢æ ·å¼ */
        .completion-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .completion-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
            padding: 40px;
            margin: 20px;
        }

        .completion-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .completion-header h1 {
            color: #28a745;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .completion-subtitle {
            color: #6c757d;
            font-size: 1.2em;
            margin: 0;
        }

        .info-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-grid div {
            font-size: 1.1em;
            color: #495057;
        }

        .summary-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .stat-item {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 120px;
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.2);
        }

        .answers-grid {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .answer-item {
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            background: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .question-header {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: flex-start;
        }

        .q-number {
            background: #007bff;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            flex-shrink: 0;
        }

        .q-text {
            font-weight: 600;
            color: #495057;
            line-height: 1.4;
            font-size: 1.1em;
        }

        .answer-details {
            margin-left: 45px;
        }

        .score-info,
        .speech-info {
            margin-bottom: 10px;
            font-size: 1em;
        }

        .selected-score {
            background: #28a745;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .speech-status {
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .can-speak {
            background: #d4edda;
            color: #155724;
        }

        .cannot-speak {
            background: #f8d7da;
            color: #721c24;
        }

        .all-options ul {
            margin: 10px 0 0 0;
            padding-left: 20px;
        }

        .all-options li {
            margin: 5px 0;
            font-size: 0.9em;
            color: #6c757d;
        }

        .all-options li.selected {
            color: #28a745;
            font-weight: 600;
            list-style-type: "âœ“ ";
        }

        .completion-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        .btn-primary,
        .btn-secondary {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
            transform: translateY(-2px);
        }

        /* è¡¨å•å…ƒç´ æ ·å¼ */
        .checkbox-cell,
        .radio-cell {
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .checkbox-cell:hover,
        .radio-cell:hover {
            background-color: rgba(139, 92, 246, 0.05);
        }

        input[type="checkbox"],
        input[type="radio"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: #8B5CF6;
            transition: all 0.3s ease;
        }

        input[type="checkbox"]:checked,
        input[type="radio"]:checked {
            transform: scale(1.1);
        }

        input:focus {
            outline: none;
        }

        /* æäº¤æŒ‰é’® */
        .submit-section {
            text-align: center;
            margin: 30px 0 15px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #8B5CF6, #6D28D9);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 30px;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(139, 92, 246, 0.2);
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(139, 92, 246, 0.3);
        }

        .submit-btn:active {
            transform: translateY(1px);
        }

        /* ç»“æœåŒºåŸŸ */
        .result-section {
            margin-top: 30px;
            padding: 20px;
            border-radius: 15px;
            background-color: #EDE9FE;
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .result-section h2 {
            color: #6D28D9;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .result-item {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .result-score {
            font-weight: 700;
            color: #6D28D9;
        }

        /* --- æ–°å¢ï¼šé˜²æ­¢ç‚¹å‡»æŒ‰é’®å’Œéäº¤äº’åŒºåŸŸæ—¶å‡ºç°æ–‡æœ¬å…‰æ ‡ --- */
        .submit-btn,
        .question-number,
        .question-description,
        .assessment-table th {
            user-select: none;
            /* æ ‡å‡†è¯­æ³• */
            -webkit-user-select: none;
            /* Safari */
            -moz-user-select: none;
            /* Firefox */
            -ms-user-select: none;
            /* IE/Edge */
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            .assessment-table th,
            .assessment-table td {
                padding: 12px 8px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 15px;
            }

            h1 {
                font-size: 1.8rem;
                margin-bottom: 20px;
            }

            .scale-description {
                font-size: 1rem;
                padding: 12px;
            }

            .assessment-table {
                font-size: 0.85rem;
            }

            .question-description {
                width: auto;
                max-width: none;
            }

            .table-wrapper {
                overflow-x: auto;
            }
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>å°å­¦ç”Ÿäº¤æµè¯„å®šé‡è¡¨</h1>

        <div class="scale-description">
            0=éå¸¸å®¹æ˜“(æ²¡æœ‰ç„¦è™‘); 1=ç›¸å½“å®¹æ˜“(æœ‰ç‚¹ç„¦è™‘); 2=æœ‰ç‚¹å›°éš¾(æœ‰ä¸å°‘ç„¦è™‘); 3=å›°éš¾(æ›´åŠ ç„¦è™‘); 4=éå¸¸å›°éš¾(é«˜åº¦ç„¦è™‘)
        </div>

        <div class="info-section">
            <div class="info-item">
                <label for="name">å§“å:</label>
                <input type="text" id="name" name="name" placeholder="è¯·è¾“å…¥å§“å">
                <i class="fas fa-user icon"></i>
            </div>

            <div class="info-item">
                <label for="grade">å¹´çº§:</label>
                <input type="text" id="grade" name="grade" placeholder="è¯·è¾“å…¥å¹´çº§">
                <i class="fas fa-graduation-cap icon"></i>
            </div>

            <div class="info-item">
                <label for="date">å¡«è¡¨æ—¥æœŸ:</label>
                <input type="date" id="date" name="date">
                <i class="fas fa-calendar-alt icon"></i>
            </div>
        </div>

        <div class="instructions">
            <p>ä»¥ä¸‹æƒ…å†µå¯¹ä½ æ¥è¯´æœ‰å¤šå®¹æ˜“æˆ–æœ‰å¤šå›°éš¾?è¯·æ ¹æ®è¯„å®šåœˆå‡º0~4ä¹‹é—´çš„æ•°å­—ã€‚</p>
            <p>å¦‚æœåœ¨è¿™äº›æƒ…å†µä¸‹ä½ å¯ä»¥è¯´è¯, è¯·åœ¨æ–¹æ¡†ä¸­æ‰“é’©(âˆš)</p>
        </div>

        <div class="table-wrapper">
            <table class="assessment-table">
                <thead>
                    <tr>
                        <th>åºå·</th>
                        <th>æƒ…å†µæè¿°</th>
                        <th>å¯ä»¥è¯´è¯</th>
                        <th>0=éå¸¸å®¹æ˜“</th>
                        <th>1=ç›¸å½“å®¹æ˜“</th>
                        <th>2=æœ‰ç‚¹å›°éš¾</th>
                        <th>3=å›°éš¾</th>
                        <th>4=éå¸¸å›°éš¾</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="question-row">
                        <td class="question-number">1</td>
                        <td class="question-description">åœ¨å®¶é‡Œå’Œäº²å¯†çš„å®¶äººäº¤è°ˆ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q1-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q1" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q1" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q1" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q1" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q1" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">2</td>
                        <td class="question-description">åœ¨å•†åº—æˆ–é¤å…ä¸ä½ çš„äº²å¯†å®¶äººäº¤è°ˆ,å…¶ä»–äººå¯èƒ½ä¼šå¬åˆ°</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q2-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q2" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q2" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q2" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q2" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q2" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">3</td>
                        <td class="question-description">åœ¨å®¶é‡Œå’Œå…¶ä»–äº²æˆšè¯´è¯</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q3-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q3" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q3" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q3" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q3" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q3" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">4</td>
                        <td class="question-description">å’Œé™Œç”Ÿäººè¯´è¯</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q4-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q4" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q4" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q4" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q4" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q4" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">5</td>
                        <td class="question-description">ç‹¬è‡ªå’Œç­ä¸»ä»»äº¤è°ˆ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q5-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q5" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q5" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q5" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q5" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q5" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">6</td>
                        <td class="question-description">åœ¨ç­ä¸Šå…¶ä»–å­©å­é¢å‰å’Œç­ä¸»ä»»äº¤è°ˆ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q6-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q6" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q6" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q6" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q6" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q6" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">7</td>
                        <td class="question-description">åœ¨å­¦æ ¡ä¸å…¶ä»–è€å¸ˆæˆ–æˆå¹´äººäº¤è°ˆ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q7-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q7" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q7" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q7" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q7" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q7" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">8</td>
                        <td class="question-description">åœ¨è¯¾å ‚ä¸Šä¸¾æ‰‹æé—®</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q8-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q8" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q8" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q8" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q8" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q8" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">9</td>
                        <td class="question-description">å‚åŠ è¯¾å ‚è®¨è®º(æå‡ºè‡ªå·±çš„æ„è§æˆ–æƒ³æ³•)</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q9-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q9" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q9" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q9" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q9" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q9" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">10</td>
                        <td class="question-description">å›ç­”å‡ºå‹¤ç‚¹å</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q10-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q10" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q10" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q10" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q10" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q10" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">11</td>
                        <td class="question-description">åŠ å…¥è¯¾å ‚å›´åæ—¶é—´çš„æ´»åŠ¨</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q11-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q11" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q11" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q11" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q11" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q11" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">12</td>
                        <td class="question-description">è¯¢é—®æ˜¯å¦å¯ä»¥ä¸Šå•æ‰€</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q12-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q12" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q12" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q12" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q12" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q12" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">13</td>
                        <td class="question-description">åœ¨ä¸ç¡®å®šè¯¥æ€ä¹ˆåšæ—¶å¯»æ±‚å¸®åŠ©</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q13-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q13" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q13" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q13" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q13" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q13" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">14</td>
                        <td class="question-description">ç‹¬è‡ªç»™ç­ä¸»ä»»æœ—è¯»</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q14-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q14" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q14" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q14" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q14" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q14" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">15</td>
                        <td class="question-description">åœ¨è¯¾å ‚å‰å¤§å£°æœ—è¯»</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q15-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q15" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q15" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q15" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q15" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q15" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">16</td>
                        <td class="question-description">æ¥è¿‘å…¶ä»–å­©å­,ä¸ä»–ä»¬è¯´è¯å’Œäº¤æœ‹å‹</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q16-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q16" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q16" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q16" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q16" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q16" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">17</td>
                        <td class="question-description">å¦‚æœå…¶ä»–å­©å­å’Œä½ è¯´è¯,ä½ ä¼šå›ç­”ä»–ä»¬</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q17-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q17" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q17" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q17" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q17" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q17" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">18</td>
                        <td class="question-description">å‘Šè¯‰å…¶ä»–å­©å­,ä»–ä»¬è®©ä½ æ„Ÿåˆ°å¾ˆçƒ¦</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q18-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q18" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q18" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q18" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q18" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q18" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">19</td>
                        <td class="question-description">å‘Šè¯‰æˆå¹´äººä½ è®¤ä¸ºä»–ä»¬çŠ¯äº†ä¸€ä¸ªé”™è¯¯</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q19-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q19" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q19" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q19" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q19" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q19" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">20</td>
                        <td class="question-description">å½“ä½ å¯èƒ½é‡åˆ°éº»çƒ¦æ—¶,ä¸æˆå¹´äººäº¤è°ˆ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q20-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q20" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q20" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q20" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q20" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q20" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">21</td>
                        <td class="question-description">åœ¨å­¦æ ¡å‘Šè¯‰æˆå¹´äººä½ æ„Ÿåˆ°ä¸èˆ’æœ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q21-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q21" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q21" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q21" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q21" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q21" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">22</td>
                        <td class="question-description">åœ¨å­¦æ ¡å‘Šè¯‰æˆå¹´äºº,æœ‰äººè®©ä½ ä¸é«˜å…´</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q22-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q22" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q22" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q22" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q22" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q22" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">23</td>
                        <td class="question-description">ç¬¬ä¸€æ¬¡ç‹¬è‡ªä¸æ–°è€å¸ˆäº¤è°ˆ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q23-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q23" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q23" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q23" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q23" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q23" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">24</td>
                        <td class="question-description">åœ¨ç­ä¸Šå…¶ä»–å­©å­é¢å‰ç¬¬ä¸€æ¬¡å’Œè€å¸ˆäº¤è°ˆ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q24-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q24" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q24" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q24" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q24" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q24" value="4"></td>
                    </tr>
                    <tr class="question-row">
                        <td class="question-number">25</td>
                        <td class="question-description">ç¬¬ä¸€æ¬¡åœ¨å­¦æ ¡å’Œä¸€ä¸ªæ–°ç”·ç”Ÿæˆ–æ–°å¥³ç”Ÿäº¤è°ˆ</td>
                        <td class="checkbox-cell"><input type="checkbox" name="q25-speech"></td>
                        <td class="radio-cell"><input type="radio" name="q25" value="0"></td>
                        <td class="radio-cell"><input type="radio" name="q25" value="1"></td>
                        <td class="radio-cell"><input type="radio" name="q25" value="2"></td>
                        <td class="radio-cell"><input type="radio" name="q25" value="3"></td>
                        <td class="radio-cell"><input type="radio" name="q25" value="4"></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="submit-section">
            <button class="submit-btn" id="calculateBtn">
                <i class="fas fa-calculator"></i> è®¡ç®—ç»“æœ
            </button>
            <button class="submit-btn" id="saveResultBtn" style="margin-left: 15px;">
                <i class="fas fa-save"></i> ä¿å­˜ç»“æœ
            </button>
            <button class="submit-btn" id="testConnectionBtn"
                style="margin-left: 15px; background: linear-gradient(135deg, #10B981, #059669);">
                <i class="fas fa-wifi"></i> æµ‹è¯•è¿æ¥
            </button>
            <button class="submit-btn" id="debugBtn"
                style="margin-left: 15px; background: linear-gradient(135deg, #F59E0B, #D97706);">
                <i class="fas fa-bug"></i> è°ƒè¯•æ•°æ®
            </button>
            <button class="submit-btn" id="testDataBtn"
                style="margin-left: 15px; background: linear-gradient(135deg, #8B5A2B, #6B4423);">
                <i class="fas fa-vial"></i> æµ‹è¯•æ”¶é›†
            </button>
        </div>

        <div class="result-section" id="resultSection">
            <h2>è¯„å®šç»“æœ</h2>
            <div class="result-item">
                <strong>æ€»å¾—åˆ†:</strong> <span class="result-score" id="totalScore">0</span>
            </div>
            <div class="result-item">
                <strong>å¹³å‡å¾—åˆ†:</strong> <span class="result-score" id="averageScore">0</span>
            </div>
            <div class="result-item">
                <strong>å¯è¯´è¯æƒ…å†µ:</strong> <span class="result-score" id="speechCount">0/25</span>
            </div>
            <div class="result-item" id="assessmentText">
                <strong>è¯„å®š:</strong> <span>è¯·å®Œæˆæ‰€æœ‰é—®é¢˜åè®¡ç®—ç»“æœ</span>
            </div>
        </div>

        <p style="text-align: center; margin-top: 20px; color: #6B7280;">è°¢è°¢!</p>
    </div>

    <script>
        // é˜²æ­¢é‡å¤æäº¤çš„æ ‡å¿—å’Œæ—¶é—´æˆ³
        let isSubmitting = false;
        let lastSubmitTime = 0;
        const SUBMIT_COOLDOWN = 3000; // 3ç§’å†·å´æ—¶é—´

        document.addEventListener('DOMContentLoaded', function () {

            // --- åŠŸèƒ½å¢å¼ºï¼šè‡ªåŠ¨è®¾ç½®å½“å¤©æ—¥æœŸ ---
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            document.getElementById('date').value = `${year}-${month}-${day}`;

            // è¯»å–localStorageä¸­ä¿å­˜çš„åŸºæœ¬ä¿¡æ¯
            const savedInfo = localStorage.getItem('basicInfo');
            if (savedInfo) {
                try {
                    const info = JSON.parse(savedInfo);
                    // å¡«å……å§“åå­—æ®µ
                    if (info.name) {
                        const nameField = document.getElementById('name');
                        if (nameField) nameField.value = info.name;
                    }
                } catch (e) {
                    console.warn('è§£æä¿å­˜çš„åŸºæœ¬ä¿¡æ¯å¤±è´¥:', e);
                }
            }

            // --- ä¼˜åŒ–ï¼šä¸ºå•å…ƒæ ¼æ·»åŠ æ›´æ™ºèƒ½çš„ç‚¹å‡»äº‹ä»¶ ---
            const tableBody = document.querySelector('.assessment-table tbody');
            tableBody.addEventListener('click', function (e) {
                const cell = e.target.closest('.checkbox-cell, .radio-cell');
                if (!cell) return;

                const input = cell.querySelector('input');
                if (input) {
                    // ç¡®ä¿äº‹ä»¶ä¸æ˜¯ä»inputæœ¬èº«è§¦å‘çš„ï¼Œé¿å…åŒé‡è§¦å‘
                    if (e.target !== input) {
                        if (input.type === 'checkbox') {
                            input.checked = !input.checked;
                        }
                        if (input.type === 'radio') {
                            input.checked = true;
                        }
                    }
                }
            });

            // --- ä¼˜åŒ–ï¼šä¸ºè¡¨æ ¼è¡ŒåŠ¨ç”»æ·»åŠ æ›´æµç•…çš„å»¶è¿Ÿæ•ˆæœ ---
            const rows = document.querySelectorAll('.assessment-table tbody tr');
            rows.forEach((row, index) => {
                row.style.opacity = '0';
                row.style.animation = `fadeIn 0.5s ease-in-out forwards ${index * 0.05}s`;
            });

            // ç»‘å®šè®¡ç®—ç»“æœæŒ‰é’®äº‹ä»¶
            document.getElementById('calculateBtn').addEventListener('click', calculateResult);

            // ç»‘å®šä¿å­˜ç»“æœæŒ‰é’®äº‹ä»¶ - æ·»åŠ é˜²é‡å¤æäº¤
            document.getElementById('saveResultBtn').addEventListener('click', function() {
                if (isSubmitting) {
                    console.log('æ­£åœ¨æäº¤ä¸­ï¼Œè¯·å‹¿é‡å¤ç‚¹å‡»');
                    return;
                }
                saveResult();
            });

            // ç»‘å®šæµ‹è¯•è¿æ¥æŒ‰é’®äº‹ä»¶
            document.getElementById('testConnectionBtn').addEventListener('click', testConnection);

            // ç»‘å®šè°ƒè¯•æŒ‰é’®äº‹ä»¶
            document.getElementById('debugBtn').addEventListener('click', function () {
                const data = debugDataStructure();
                if (data) {
                    alert(`è°ƒè¯•ä¿¡æ¯å·²è¾“å‡ºåˆ°æ§åˆ¶å°\n\næ•°æ®é¡¹æ•°: ${data.length}\nè¯·æŒ‰F12æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯`);
                } else {
                    alert('æ•°æ®è°ƒè¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ä¿¡æ¯');
                }
            });

            // ç»‘å®šæµ‹è¯•æ”¶é›†æŒ‰é’®äº‹ä»¶
            document.getElementById('testDataBtn').addEventListener('click', function () {
                const count = testDataCollection();
                alert(`æ•°æ®æ”¶é›†æµ‹è¯•å®Œæˆ\n\næ‰¾åˆ° ${count} ä¸ªé—®é¢˜\nè¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹æ§åˆ¶å°`);
            });
        });

        /**
         * è®¡ç®—å¹¶æ˜¾ç¤ºè¯„ä¼°ç»“æœ
         */
        function calculateResult() {
            const questionRows = document.querySelectorAll('.assessment-table .question-row');
            const totalQuestions = questionRows.length;

            let totalScore = 0;
            let answeredQuestions = 0;
            let speechCount = 0;

            // --- ä¼˜åŒ–ï¼šåŠ¨æ€éå†æ‰€æœ‰é—®é¢˜è¡Œ ---
            questionRows.forEach(row => {
                const radios = row.querySelectorAll('input[type="radio"]');
                const speechCheckbox = row.querySelector('input[type="checkbox"]');

                let selectedValue = null;
                for (const radio of radios) {
                    if (radio.checked) {
                        selectedValue = parseInt(radio.value, 10);
                        break;
                    }
                }

                if (speechCheckbox && speechCheckbox.checked) {
                    speechCount++;
                }

                if (selectedValue !== null) {
                    totalScore += selectedValue;
                    answeredQuestions++;
                }
            });

            // --- åŠŸèƒ½å¢å¼ºï¼šæ£€æŸ¥æ˜¯å¦æ‰€æœ‰é—®é¢˜éƒ½å·²å›ç­” ---
            if (answeredQuestions < totalQuestions) {
                alert(`è¯·å®Œæˆæ‰€æœ‰ ${totalQuestions} é“é¢˜ç›®åå†è®¡ç®—ç»“æœã€‚\næ‚¨å½“å‰å®Œæˆäº† ${answeredQuestions} é“ã€‚`);
                return;
            }

            // æ˜¾ç¤ºç»“æœåŒºåŸŸ
            const resultSection = document.getElementById('resultSection');
            const averageScore = (totalScore / totalQuestions).toFixed(1);

            document.getElementById('totalScore').textContent = totalScore;
            document.getElementById('averageScore').textContent = averageScore;
            document.getElementById('speechCount').textContent = `${speechCount}/${totalQuestions}`;

            // æ ¹æ®å¹³å‡åˆ†ç»™å‡ºè¯„å®š
            let assessmentText = '';
            if (averageScore <= 1) {
                assessmentText = 'äº¤æµèƒ½åŠ›è‰¯å¥½ï¼Œç„¦è™‘ç¨‹åº¦ä½';
            } else if (averageScore <= 2) {
                assessmentText = 'äº¤æµèƒ½åŠ›ä¸­ç­‰ï¼Œæœ‰è½»å¾®ç„¦è™‘';
            } else if (averageScore <= 3) {
                assessmentText = 'äº¤æµå­˜åœ¨ä¸€å®šå›°éš¾ï¼Œç„¦è™‘ç¨‹åº¦è¾ƒé«˜';
            } else {
                assessmentText = 'äº¤æµå›°éš¾è¾ƒå¤§ï¼Œç„¦è™‘ç¨‹åº¦é«˜ï¼Œå»ºè®®è¿›ä¸€æ­¥å…³æ³¨';
            }
            document.querySelector('#assessmentText span').textContent = assessmentText;

            resultSection.style.display = 'block';
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        /**
         * æµ‹è¯•ç½‘ç»œè¿æ¥ï¼ˆç”¨æˆ·æ‰‹åŠ¨è§¦å‘ï¼‰
         */
        async function testConnection() {
            const btn = document.getElementById('testConnectionBtn');
            const originalText = btn.innerHTML;

            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> æµ‹è¯•ä¸­...';
            btn.disabled = true;

            try {
                console.log('ç”¨æˆ·æ‰‹åŠ¨æµ‹è¯•ç½‘ç»œè¿æ¥...');
                const diagnostics = await diagnoseConnection();

                let message = 'ğŸ” ç½‘ç»œè¿æ¥è¯Šæ–­ç»“æœï¼š\n\n';
                message += `æœåŠ¡å™¨å¯è¾¾æ€§: ${diagnostics.serverReachable ? 'âœ… æ­£å¸¸' : 'âŒ å¤±è´¥'}\n`;
                message += `CORSé…ç½®: ${diagnostics.corsEnabled ? 'âœ… æ­£å¸¸' : 'âŒ å¤±è´¥'}\n`;
                message += `APIç«¯ç‚¹: ${diagnostics.apiEndpoint ? 'âœ… æ­£å¸¸' : 'âŒ å¤±è´¥'}\n\n`;

                if (diagnostics.serverReachable && diagnostics.corsEnabled && diagnostics.apiEndpoint) {
                    message += 'ğŸ‰ ç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œå¯ä»¥ä¿å­˜æ•°æ®ï¼';
                } else {
                    message += 'âš ï¸ å‘ç°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š\n';
                    if (!diagnostics.serverReachable) {
                        message += 'â€¢ ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ (python app.py)\n';
                    }
                    if (!diagnostics.corsEnabled) {
                        message += 'â€¢ æ£€æŸ¥åç«¯CORSé…ç½®\n';
                    }
                    if (!diagnostics.apiEndpoint) {
                        message += 'â€¢ æ£€æŸ¥APIç«¯ç‚¹é…ç½®\n';
                    }
                }

                alert(message);
            } catch (error) {
                console.error('è¿æ¥æµ‹è¯•å¤±è´¥:', error);
                alert(`è¿æ¥æµ‹è¯•å¤±è´¥: ${error.message}`);
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        /**
         * æµ‹è¯•æ•°æ®æ”¶é›†
         */
        function testDataCollection() {
            console.log('=== æ•°æ®æ”¶é›†æµ‹è¯• ===');

            // æ£€æŸ¥æ‰€æœ‰é—®é¢˜è¡Œ
            const questionRows = document.querySelectorAll('.assessment-table .question-row');
            console.log(`æ‰¾åˆ° ${questionRows.length} ä¸ªé—®é¢˜è¡Œ`);

            questionRows.forEach((row, index) => {
                const questionNumber = index + 1;
                const radios = row.querySelectorAll('input[type="radio"]');
                const speechCheckbox = row.querySelector('input[type="checkbox"]');

                console.log(`é—®é¢˜ ${questionNumber}:`);
                console.log(`  - å•é€‰æŒ‰é’®æ•°é‡: ${radios.length}`);
                console.log(`  - è¯´è¯å¤é€‰æ¡†: ${speechCheckbox ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}`);

                let hasSelected = false;
                radios.forEach((radio, radioIndex) => {
                    if (radio.checked) {
                        console.log(`  - é€‰ä¸­é€‰é¡¹: ${radio.value} (ç´¢å¼• ${radioIndex})`);
                        hasSelected = true;
                    }
                });

                if (!hasSelected) {
                    console.log(`  - æœªé€‰æ‹©ä»»ä½•é€‰é¡¹`);
                }

                if (speechCheckbox) {
                    console.log(`  - è¯´è¯èƒ½åŠ›: ${speechCheckbox.checked ? 'å¯ä»¥' : 'ä¸å¯ä»¥'}`);
                }
            });

            return questionRows.length;
        }

        /**
         * è°ƒè¯•æ•°æ®ç»“æ„
         */
        function debugDataStructure() {
            console.log('=== æ•°æ®ç»“æ„è°ƒè¯• ===');

            try {
                const detailedData = collectDetailedData();
                console.log('detailedData:', detailedData);
                console.log('detailedData.length:', detailedData.length);
                console.log('detailedData[0]:', detailedData[0]);

                if (detailedData.length > 0) {
                    const firstItem = detailedData[0];
                    console.log('ç¬¬ä¸€é¡¹çš„å±æ€§:');
                    Object.keys(firstItem).forEach(key => {
                        console.log(`  ${key}:`, firstItem[key]);
                    });
                }

                return detailedData;
            } catch (error) {
                console.error('æ•°æ®ç»“æ„è°ƒè¯•å¤±è´¥:', error);
                return null;
            }
        }

        /**
         * ç½‘ç»œè¿æ¥è¯Šæ–­
         */
        async function diagnoseConnection() {
            console.log('å¼€å§‹ç½‘ç»œè¿æ¥è¯Šæ–­...');

            const diagnostics = {
                serverReachable: false,
                corsEnabled: false,
                apiEndpoint: false
            };

            try {
                // æµ‹è¯•åŸºæœ¬è¿æ¥
                const response = await fetch(CONFIG.getPageUrl('/'), {
                    method: 'GET',
                    mode: 'no-cors'
                });
                diagnostics.serverReachable = true;
                console.log('âœ… æœåŠ¡å™¨å¯è¾¾');
            } catch (error) {
                console.log('âŒ æœåŠ¡å™¨ä¸å¯è¾¾:', error.message);
            }

            try {
                // æµ‹è¯•CORS
                const response = await fetch(CONFIG.getApiUrl(CONFIG.API.SUBMIT), {
                    method: 'OPTIONS',
                    mode: 'cors'
                });
                diagnostics.corsEnabled = true;
                console.log('âœ… CORSé…ç½®æ­£å¸¸');
            } catch (error) {
                console.log('âŒ CORSé…ç½®é—®é¢˜:', error.message);
            }

            try {
                // æµ‹è¯•APIç«¯ç‚¹ - ä½¿ç”¨HEADè¯·æ±‚é¿å…400é”™è¯¯
                const response = await fetch(CONFIG.getApiUrl(CONFIG.API.SUBMIT), {
                    method: 'HEAD',
                    mode: 'cors'
                });
                diagnostics.apiEndpoint = response.status !== 404;
                console.log('âœ… APIç«¯ç‚¹å¯ç”¨');
            } catch (error) {
                // å¦‚æœHEADä¸æ”¯æŒï¼Œå°è¯•OPTIONS
                try {
                    const optionsResponse = await fetch(CONFIG.getApiUrl(CONFIG.API.SUBMIT), {
                        method: 'OPTIONS',
                        mode: 'cors'
                    });
                    diagnostics.apiEndpoint = optionsResponse.status !== 404;
                    console.log('âœ… APIç«¯ç‚¹å¯ç”¨');
                } catch (optionsError) {
                    console.log('âŒ APIç«¯ç‚¹é—®é¢˜:', error.message);
                }
            }

            return diagnostics;
        }

        /**
         * ä¿å­˜è¯„ä¼°ç»“æœåˆ°åç«¯ï¼ˆå¢å¼ºç‰ˆï¼ŒåŒ…å«è¯¦ç»†æ•°æ®ï¼‰
         */
        async function saveResult() {
            // é˜²æ­¢é‡å¤æäº¤ - åŒé‡æ£€æŸ¥
            const currentTime = Date.now();
            if (isSubmitting) {
                console.log('æ­£åœ¨æäº¤ä¸­ï¼Œè¯·å‹¿é‡å¤ç‚¹å‡»');
                return;
            }
            
            if (currentTime - lastSubmitTime < SUBMIT_COOLDOWN) {
                console.log(`è¯·ç­‰å¾… ${Math.ceil((SUBMIT_COOLDOWN - (currentTime - lastSubmitTime)) / 1000)} ç§’åå†æ¬¡æäº¤`);
                return;
            }

            isSubmitting = true;
            lastSubmitTime = currentTime;
            const saveBtn = document.getElementById('saveResultBtn');
            saveBtn.disabled = true;
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> æäº¤ä¸­...';

            try {
                // é¦–å…ˆéªŒè¯æ‰€æœ‰é—®é¢˜æ˜¯å¦å·²å›ç­”
                const detailedData = collectDetailedData();

                if (!detailedData || !Array.isArray(detailedData) || detailedData.length === 0) {
                    alert('æ•°æ®æ”¶é›†å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•ã€‚');
                    // æ¢å¤æŒ‰é’®çŠ¶æ€å’Œæäº¤æ ‡å¿—
                    isSubmitting = false;
                    saveBtn.disabled = false;
                    saveBtn.innerHTML = '<i class="fas fa-save"></i> ä¿å­˜ç»“æœ';
                    return;
                }

                const unansweredQuestions = detailedData.filter(q => q.selectedOption === null || q.selectedOption === undefined);

                if (unansweredQuestions.length > 0) {
                    alert(`è¯·å®Œæˆæ‰€æœ‰ ${detailedData.length} é“é¢˜ç›®åå†ä¿å­˜ç»“æœã€‚\næ‚¨è¿˜æœ‰ ${unansweredQuestions.length} é“é¢˜ç›®æœªå®Œæˆã€‚`);
                    // æ¢å¤æŒ‰é’®çŠ¶æ€å’Œæäº¤æ ‡å¿—
                    isSubmitting = false;
                    saveBtn.disabled = false;
                    saveBtn.innerHTML = '<i class="fas fa-save"></i> ä¿å­˜ç»“æœ';
                    return;
                }

                // æ”¶é›†åŸºæœ¬ä¿¡æ¯
                const basicInfo = {
                    name: document.getElementById('name').value || '',
                    grade: document.getElementById('grade').value || '',
                    date: document.getElementById('date').value || ''
                };

                // æ”¶é›†è¯¦ç»†é—®å·ç­”æ¡ˆ
                const detailedAnswers = {};
                detailedData.forEach(data => {
                    // ç¡®ä¿æ‰€æœ‰å€¼éƒ½ä¸æ˜¯undefined
                    const questionKey = `q${data.questionNumber}`;
                    
                    // æ›´ä¸¥æ ¼çš„æ•°æ®éªŒè¯å’Œé»˜è®¤å€¼å¤„ç†
                    const score = (data.selectedOption !== null && data.selectedOption !== undefined && !isNaN(data.selectedOption)) 
                        ? data.selectedOption 
                        : null;
                    
                    const scoreText = data.selectedText && data.selectedText !== 'undefined' && data.selectedText !== 'æœªé€‰æ‹©'
                        ? data.selectedText 
                        : (score !== null ? `${score}åˆ†` : 'æœªé€‰æ‹©');
                    
                    detailedAnswers[questionKey] = {
                        questionText: data.questionText || `é—®é¢˜ ${data.questionNumber}`,
                        score: score,
                        scoreText: scoreText,
                        canSpeak: Boolean(data.canSpeak),
                        canSpeakText: data.canSpeakText || (data.canSpeak ? 'å¯ä»¥è¯´è¯' : 'ä¸å¯ä»¥è¯´è¯'),
                        allOptions: data.options && Array.isArray(data.options) ? data.options.map(opt => ({
                            value: opt.value !== undefined ? opt.value : -1,
                            text: opt.text || '',
                            selected: Boolean(opt.selected)
                        })) : []
                    };

                    // è°ƒè¯•è¾“å‡º
                    console.log(`é—®é¢˜ ${data.questionNumber}:`, {
                        åŸå§‹æ•°æ®: data,
                        å¤„ç†åæ•°æ®: detailedAnswers[questionKey]
                    });
                });

                // è®¡ç®—ç»Ÿè®¡æ•°æ®
                const totalScore = detailedData.reduce((sum, q) => sum + (q.selectedOption || 0), 0);
                const averageScore = (totalScore / detailedData.length).toFixed(1);
                const speechCount = detailedData.filter(q => q.canSpeak).length;

                // éªŒè¯åŸºæœ¬ä¿¡æ¯
                const validationErrors = [];
                if (!basicInfo.name.trim()) {
                    validationErrors.push('è¯·å¡«å†™å§“å');
                }
                if (!basicInfo.grade.trim()) {
                    validationErrors.push('è¯·å¡«å†™å¹´çº§');
                }
                if (!basicInfo.date) {
                    validationErrors.push('è¯·é€‰æ‹©å¡«è¡¨æ—¥æœŸ');
                }

                if (validationErrors.length > 0) {
                    alert('âŒ è¯·å®Œå–„ä»¥ä¸‹ä¿¡æ¯ï¼š\n' + validationErrors.join('\n'));
                    isSubmitting = false;
                    saveBtn.disabled = false;
                    saveBtn.innerHTML = '<i class="fas fa-save"></i> ä¿å­˜ç»“æœ';
                    return;
                }

                // æ„å»ºç¬¦åˆAPIæ ‡å‡†çš„é—®é¢˜æ•°æ®
                const questions = detailedData.map((q, index) => ({
                    id: index + 1,
                    type: 'multiple_choice',
                    question: q.questionText,
                    options: [
                        { value: 0, text: 'éå¸¸å®¹æ˜“(æ²¡æœ‰ç„¦è™‘)' },
                        { value: 1, text: 'ç›¸å½“å®¹æ˜“(æœ‰ç‚¹ç„¦è™‘)' },
                        { value: 2, text: 'æœ‰ç‚¹å›°éš¾(æœ‰ä¸å°‘ç„¦è™‘)' },
                        { value: 3, text: 'å›°éš¾(æ›´åŠ ç„¦è™‘)' },
                        { value: 4, text: 'éå¸¸å›°éš¾(é«˜åº¦ç„¦è™‘)' }
                    ],
                    selected: [q.selectedOption],
                    can_speak: q.canSpeak
                }));

                // æ„å»ºè¦æäº¤çš„å®Œæ•´æ•°æ® - ç¬¦åˆAPIæ ‡å‡†æ ¼å¼
                const dataToSubmit = {
                    type: 'elementary_school_communication_assessment',
                    basic_info: {
                        name: basicInfo.name.trim(),
                        grade: basicInfo.grade.trim(),
                        submission_date: basicInfo.date
                    },
                    questions: questions,
                    statistics: {
                        total_score: totalScore,
                        completion_rate: 100,
                        submission_time: new Date().toISOString()
                    }
                };

                try {
                    console.log('=== æäº¤æ•°æ®è°ƒè¯• ===');
                    console.log('è¯¦ç»†æ•°æ®:', detailedData);
                    console.log('è¯¦ç»†ç­”æ¡ˆ:', detailedAnswers);
                    console.log('å®Œæ•´æäº¤æ•°æ®:', dataToSubmit);

                    // æ£€æŸ¥æ˜¯å¦æœ‰undefinedå€¼
                    Object.keys(detailedAnswers).forEach(key => {
                        const answer = detailedAnswers[key];
                        if (answer.score === undefined || answer.score === null) {
                            console.warn(`è­¦å‘Š: ${key} çš„scoreæ˜¯ ${answer.score}`);
                        }
                    });

                    // è¿è¡Œç½‘ç»œè¯Šæ–­
                    console.log('æ­£åœ¨è¿›è¡Œç½‘ç»œè¿æ¥è¯Šæ–­...');
                    const diagnostics = await diagnoseConnection();

                    if (!diagnostics.serverReachable) {
                        throw new Error('æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¯·ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ (python app.py)');
                    }

                    if (!diagnostics.corsEnabled) {
                        throw new Error('CORSé…ç½®é—®é¢˜ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡å™¨é…ç½®');
                    }

                    // å‘é€POSTè¯·æ±‚åˆ°åç«¯API
                    const response = await fetch(CONFIG.getApiUrl(CONFIG.API.SUBMIT), {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Accept': 'application/json'
                        },
                        body: JSON.stringify(dataToSubmit),
                        mode: 'cors'
                    });

                    console.log('å“åº”çŠ¶æ€:', response.status);
                    console.log('å“åº”å¤´:', response.headers);

                    // å¤„ç†å“åº”
                    if (response.ok) {
                        const result = await response.json();
                        console.log('ä¿å­˜æˆåŠŸ:', result);
                        
                        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                        if (result.success) {
                            alert('âœ… æ•°æ®ä¿å­˜æˆåŠŸï¼\né—®å·ID: ' + (result.id || result.record_id));
                            showCompletion(result.id || result.record_id);
                        } else {
                            throw new Error(result.error?.message || 'ä¿å­˜å¤±è´¥');
                        }
                    } else {
                        let errorMessage = `æœåŠ¡å™¨é”™è¯¯ (${response.status})`;
                        try {
                            const errorData = await response.json();
                            if (errorData.error) {
                                if (errorData.error.details && Array.isArray(errorData.error.details)) {
                                    errorMessage = 'æ•°æ®éªŒè¯å¤±è´¥ï¼š\n' + errorData.error.details.join('\n');
                                } else {
                                    errorMessage = errorData.error.message || errorData.message || errorMessage;
                                }
                            }
                        } catch (e) {
                            errorMessage = `HTTP ${response.status}: ${response.statusText}`;
                        }
                        console.error('ä¿å­˜å¤±è´¥:', errorMessage);
                        alert(`âŒ æ•°æ®ä¿å­˜å¤±è´¥:\n${errorMessage}`);

                        // æ¢å¤æŒ‰é’®çŠ¶æ€
                        saveBtn.disabled = false;
                        saveBtn.innerHTML = '<i class="fas fa-save"></i> ä¿å­˜ç»“æœ';
                    }
                } catch (error) {
                    console.error('æäº¤æ•°æ®æ—¶å‡ºé”™:', error);

                    // è¯¦ç»†çš„é”™è¯¯è¯Šæ–­
                    let errorMessage = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹æƒ…å†µï¼š\n\n';

                    if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                        errorMessage += 'âŒ ç½‘ç»œè¿æ¥é—®é¢˜ï¼š\n';
                        errorMessage += '  â€¢ ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆè¿è¡Œ python app.pyï¼‰\n';
                        errorMessage += '  â€¢ æ£€æŸ¥æœåŠ¡å™¨åœ°å€æ˜¯å¦æ­£ç¡® (127.0.0.1:5000)\n';
                        errorMessage += '  â€¢ æ£€æŸ¥é˜²ç«å¢™è®¾ç½®\n\n';
                    } else if (error.message.includes('CORS')) {
                        errorMessage += 'âŒ è·¨åŸŸé—®é¢˜ï¼š\n';
                        errorMessage += '  â€¢ åç«¯CORSé…ç½®å¯èƒ½æœ‰é—®é¢˜\n';
                        errorMessage += '  â€¢ è¯·è”ç³»æŠ€æœ¯æ”¯æŒ\n\n';
                    } else {
                        errorMessage += 'âŒ å…¶ä»–é”™è¯¯ï¼š\n';
                        errorMessage += `  â€¢ ${error.message}\n\n`;
                    }

                    errorMessage += 'ğŸ’¡ å»ºè®®è§£å†³æ–¹æ¡ˆï¼š\n';
                    errorMessage += '1. åˆ·æ–°é¡µé¢åé‡è¯•\n';
                    errorMessage += '2. æ£€æŸ¥ç½‘ç»œè¿æ¥\n';
                    errorMessage += '3. ç¡®è®¤åç«¯æœåŠ¡çŠ¶æ€\n';
                    errorMessage += '4. å¦‚æœé—®é¢˜æŒç»­ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒ';

                    alert(errorMessage);

                    // é‡ç½®æäº¤çŠ¶æ€å’ŒæŒ‰é’®çŠ¶æ€
                    isSubmitting = false;
                    saveBtn.disabled = false;
                    saveBtn.innerHTML = '<i class="fas fa-save"></i> ä¿å­˜ç»“æœ';

                    // æä¾›è¯Šæ–­é€‰é¡¹ï¼ˆç§»é™¤è‡ªåŠ¨é‡è¯•ä»¥é˜²æ­¢é‡å¤æäº¤ï¼‰
                    const userChoice = confirm('æ˜¯å¦è¿›è¡Œç½‘ç»œè¯Šæ–­ï¼Ÿ\n\nç‚¹å‡»"ç¡®å®š"è¿›è¡Œè¯Šæ–­\nç‚¹å‡»"å–æ¶ˆ"æ‰‹åŠ¨é‡è¯•');

                    if (userChoice) {
                        // è¿è¡Œç½‘ç»œè¯Šæ–­
                        setTimeout(() => testConnection(), 500);
                    }
                }
            } catch (error) {
                console.error('æäº¤æ•°æ®æ—¶å‡ºé”™:', error);
                alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥åé‡è¯•ã€‚');

                // æ¢å¤æŒ‰é’®çŠ¶æ€
                isSubmitting = false;
                saveBtn.disabled = false;
                saveBtn.innerHTML = '<i class="fas fa-save"></i> ä¿å­˜ç»“æœ';
            }
        }

        /**
         * æ˜¾ç¤ºå®Œæˆé¡µé¢
         */
        function showCompletion(recordId) {
            try {
                // éšè—é—®å·åŒºåŸŸ
                const container = document.querySelector('.container');
                if (container) {
                    container.style.display = 'none';
                }

                // è·å–è¯¦ç»†æ•°æ®
                const detailedData = collectDetailedData();

                if (!detailedData || !Array.isArray(detailedData) || detailedData.length === 0) {
                    alert('æ•°æ®è·å–å¤±è´¥ï¼Œæ— æ³•æ˜¾ç¤ºå®Œæˆé¡µé¢');
                    return;
                }

                // åˆ›å»ºå®Œæˆé¡µé¢
                const completionPage = document.createElement('div');
                completionPage.className = 'completion-page';

                let totalScore = 0;
                let speechCount = 0;

                detailedData.forEach(item => {
                    if (item && typeof item.selectedOption === 'number') {
                        totalScore += item.selectedOption;
                    }
                    if (item && item.canSpeak) {
                        speechCount++;
                    }
                });

                const averageScore = (totalScore / detailedData.length).toFixed(1);

                completionPage.innerHTML = `
                <div class="completion-container">
                    <div class="completion-header">
                        <h1><i class="fa fa-check-circle"></i> é—®å·å®Œæˆ</h1>
                        <p class="completion-subtitle">å°å­¦ç”Ÿäº¤æµè¯„å®šè¡¨å·²æˆåŠŸä¿å­˜</p>
                    </div>
                    
                    <div class="completion-info">
                        <div class="info-card">
                            <h3><i class="fa fa-info-circle"></i> åŸºæœ¬ä¿¡æ¯</h3>
                            <div class="info-grid">
                                <div><strong>å§“å:</strong> ${document.getElementById('name').value}</div>
                                <div><strong>å¹´çº§:</strong> ${document.getElementById('grade').value}</div>
                                <div><strong>æ—¥æœŸ:</strong> ${document.getElementById('date').value}</div>
                                <div><strong>è®°å½•ID:</strong> ${recordId}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="completion-answers">
                        <h3><i class="fa fa-list-alt"></i> å›ç­”æ€»è§ˆ</h3>
                        
                        <div class="summary-stats">
                            <div class="stat-item">
                                <strong>æ€»åˆ†æ•°:</strong> ${totalScore}åˆ†
                            </div>
                            <div class="stat-item">
                                <strong>å¹³å‡åˆ†:</strong> ${averageScore}åˆ†
                            </div>
                            <div class="stat-item">
                                <strong>å¯ä»¥è¯´è¯çš„é—®é¢˜:</strong> ${speechCount}ä¸ª
                            </div>
                            <div class="stat-item">
                                <strong>æ€»é—®é¢˜æ•°:</strong> ${detailedData.length}ä¸ª
                            </div>
                        </div>
                        
                        <div class="answers-grid">
                            ${detailedData && Array.isArray(detailedData) ? detailedData.map(item => `
                                <div class="answer-item">
                                    <div class="question-header">
                                        <div class="q-number">${item.questionNumber || '?'}</div>
                                        <div class="q-text">${item.questionText || 'æœªçŸ¥é—®é¢˜'}</div>
                                    </div>
                                    <div class="answer-details">
                                        <div class="score-info">
                                            <strong>è¯„åˆ†:</strong> ${item.selectedOption === null ? 'æœªé€‰æ‹© - 0 = éå¸¸å®¹æ˜“' : `${item.selectedOption} = ${item.selectedText}`}
                                        </div>
                                        <div class="speech-info">
                                            <strong>è¯´è¯èƒ½åŠ›:</strong> 
                                            <span class="speech-status ${item.canSpeak ? 'can-speak' : 'cannot-speak'}">
                                                ${item.canSpeak ? 'å¯ä»¥è¯´è¯' : 'ä¸èƒ½è¯´è¯'}
                                            </span>
                                        </div>
                                        <div class="all-options">
                                            <strong>æ‰€æœ‰é€‰é¡¹:</strong>
                                            <ul>
                                                ${item.options ? item.options.map(opt =>
                    `<li class="${opt.selected ? 'selected' : ''}">${opt.value}=${opt.text}</li>`
                ).join('') : ''}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            `).join('') : '<p>æš‚æ— æ•°æ®</p>'}
                        </div>
                    </div>
                    
                    <div class="completion-actions">
                        <button class="btn-primary" onclick="window.location.reload()">
                            <i class="fa fa-refresh"></i> å¡«å†™æ–°é—®å·
                        </button>
                        <button class="btn-secondary" onclick="window.print()">
                            <i class="fa fa-print"></i> æ‰“å°
                        </button>
                    </div>
                </div>
            `;

                document.body.appendChild(completionPage);
            } catch (error) {
                console.error('æ˜¾ç¤ºå®Œæˆé¡µé¢æ—¶å‡ºé”™:', error);
                alert('æ˜¾ç¤ºå®Œæˆé¡µé¢å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•');

                // æ¢å¤é—®å·æ˜¾ç¤º
                const container = document.querySelector('.container');
                if (container) {
                    container.style.display = 'block';
                }
            }
        }

        /**
         * æ˜¾ç¤ºè¯¦ç»†çš„é—®å·æ•°æ®
         */
        function generateAnswersHTML() {
            const questionRows = document.querySelectorAll('.assessment-table .question-row');
            let html = '<div class="answers-table">';

            questionRows.forEach((row, index) => {
                const questionNumber = index + 1;
                const questionText = row.querySelector('.question-description').textContent.trim();
                const radios = row.querySelectorAll('input[type="radio"]');
                const speechCheckbox = row.querySelector('input[type="checkbox"]');

                let selectedValue = null;
                let selectedText = 'æœªé€‰æ‹©';
                for (const radio of radios) {
                    if (radio.checked) {
                        selectedValue = parseInt(radio.value, 10);
                        selectedText = radio.nextElementSibling.textContent;
                        break;
                    }
                }

                const canSpeak = speechCheckbox ? (speechCheckbox.checked ? 'æ˜¯' : 'å¦') : 'ä¸é€‚ç”¨';

                html += `
                    <div class="answer-row">
                        <div class="answer-question">
                            <strong>é—®é¢˜ ${questionNumber}:</strong> ${questionText}
                        </div>
                        <div class="answer-details">
                            <span class="answer-score">è¯„åˆ†: ${selectedText}</span>
                            <span class="answer-speech">èƒ½è¯´è¯: ${canSpeak}</span>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            return html;
        }



        /**
         * æ”¶é›†è¯¦ç»†çš„é—®å·æ•°æ®ï¼ˆé—®é¢˜ã€æ‰€æœ‰é€‰é¡¹ã€é€‰ä¸­é€‰é¡¹ã€è¯´è¯èƒ½åŠ›çŠ¶æ€ï¼‰
         */
        function collectDetailedData() {
            const questionRows = document.querySelectorAll('.assessment-table .question-row');
            const detailedData = [];

            if (!questionRows || questionRows.length === 0) {
                console.warn('æœªæ‰¾åˆ°é—®é¢˜è¡Œ');
                return [];
            }

            questionRows.forEach((row, index) => {
                try {
                    const questionNumber = index + 1;
                    const questionDescElement = row.querySelector('.question-description');
                    const questionText = questionDescElement ? questionDescElement.textContent.trim() : `é—®é¢˜ ${questionNumber}`;
                    const radios = row.querySelectorAll('input[type="radio"]');
                    const speechCheckbox = row.querySelector('input[type="checkbox"]');

                    // æ”¶é›†æ‰€æœ‰é€‰é¡¹
                    const options = [];
                    let selectedOption = null;
                    let selectedText = 'æœªé€‰æ‹©';

                    const optionTexts = ['0=éå¸¸å®¹æ˜“', '1=ç›¸å½“å®¹æ˜“', '2=æœ‰ç‚¹å›°éš¾', '3=å›°éš¾', '4=éå¸¸å›°éš¾'];
                    radios.forEach((radio, radioIndex) => {
                        const option = {
                            value: parseInt(radio.value),
                            text: optionTexts[radioIndex] || `é€‰é¡¹${radioIndex}`,
                            selected: radio.checked
                        };
                        options.push(option);

                        if (radio.checked) {
                            selectedOption = option.value;
                            selectedText = option.text;
                        }
                    });

                    // å¦‚æœæ²¡æœ‰é€‰æ‹©ä»»ä½•é€‰é¡¹ï¼Œè®¾ç½®é»˜è®¤å€¼
                    if (selectedOption === null) {
                        selectedText = 'æœªé€‰æ‹©';
                    }

                    // æ”¶é›†è¯´è¯èƒ½åŠ›çŠ¶æ€
                    const canSpeak = speechCheckbox ? speechCheckbox.checked : false;

                    // æ„å»ºè¯¦ç»†æ•°æ®å¯¹è±¡
                    const questionData = {
                        questionNumber: questionNumber,
                        questionText: questionText,
                        options: options,
                        selectedOption: selectedOption,
                        selectedText: selectedText,
                        canSpeak: canSpeak,
                        canSpeakText: canSpeak ? 'å¯ä»¥è¯´è¯' : 'ä¸å¯ä»¥è¯´è¯'
                    };

                    detailedData.push(questionData);
                } catch (error) {
                    console.error(`å¤„ç†é—®é¢˜ ${index + 1} æ—¶å‡ºé”™:`, error);
                    // æ·»åŠ ä¸€ä¸ªé»˜è®¤çš„é—®é¢˜æ•°æ®
                    detailedData.push({
                        questionNumber: index + 1,
                        questionText: `é—®é¢˜ ${index + 1}`,
                        options: [],
                        selectedOption: null,
                        selectedText: 'æœªé€‰æ‹©',
                        canSpeak: false,
                        canSpeakText: 'ä¸å¯ä»¥è¯´è¯'
                    });
                }
            });

            return detailedData;
        }

        /**
         * æ˜¾ç¤ºè¯¦ç»†çš„é—®å·æ•°æ®æ‘˜è¦
         */
        function showDetailedSummary() {
            const detailedData = collectDetailedData();
            let summaryHTML = '<div class="detailed-summary">';

            detailedData.forEach((data, index) => {
                summaryHTML += `
                    <div class="question-summary">
                        <h4>é—®é¢˜ ${data.questionNumber}: ${data.questionText}</h4>
                        <div class="selected-info">
                            <strong>é€‰ä¸­é€‰é¡¹:</strong> ${data.selectedText || 'æœªé€‰æ‹©'} 
                            <span class="speak-status">(${data.canSpeakText})</span>
                        </div>
                        <div class="all-options">
                            <strong>æ‰€æœ‰é€‰é¡¹:</strong>
                            <ul>
                                ${data.options.map(opt =>
                    `<li class="${opt.selected ? 'selected' : ''}">
                                        ${opt.text} ${opt.selected ? 'âœ“' : ''}
                                    </li>`
                ).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            });

            summaryHTML += '</div>';
            return summaryHTML;
        }
    </script>
</body>

</html>