# 问卷数据管理系统 - 管理员使用手册

## 目录

1. [系统概述](#系统概述)
2. [登录系统](#登录系统)
3. [管理后台界面](#管理后台界面)
4. [问卷数据管理](#问卷数据管理)
5. [批量操作](#批量操作)
6. [数据导出](#数据导出)
7. [系统监控](#系统监控)
8. [用户管理](#用户管理)
9. [系统设置](#系统设置)
10. [故障排除](#故障排除)

## 系统概述

问卷数据管理系统是一个用于收集、存储和管理问卷数据的 Web 应用程序。系统支持多种问题类型，提供完整的数据管理功能，包括查看、编辑、删除和导出问卷数据。

### 主要功能

- **数据收集**：支持多种问题类型的问卷数据收集
- **数据管理**：完整的 CRUD（创建、读取、更新、删除）操作
- **批量操作**：支持批量删除和导出功能
- **数据导出**：支持 CSV、Excel、PDF 格式导出
- **搜索筛选**：强大的搜索和筛选功能
- **系统监控**：实时系统状态监控
- **操作日志**：完整的操作审计日志

### 系统架构

```
前端界面 ←→ Flask 后端 ←→ SQLite 数据库
    ↓           ↓           ↓
 用户交互    API 接口    数据存储
```

## 登录系统

### 访问管理后台

1. 打开浏览器，访问系统地址：`http://your-domain.com`
2. 如果未登录，系统会自动跳转到登录页面

### 登录步骤

1. **输入凭据**
   - 用户名：输入管理员用户名（默认：`admin`）
   - 密码：输入管理员密码

2. **点击登录**
   - 点击"登录"按钮提交凭据
   - 系统验证成功后跳转到管理后台

3. **登录状态**
   - 登录成功后，会话将保持 2 小时
   - 系统会在会话即将过期时显示警告
   - 可以通过刷新页面延长会话时间

### 登录安全

- **密码安全**：使用强密码，包含大小写字母、数字和特殊字符
- **会话管理**：系统会自动检测会话超时并要求重新登录
- **登录日志**：所有登录活动都会被记录在操作日志中

## 管理后台界面

### 界面布局

管理后台采用响应式设计，主要包含以下区域：

```
┌─────────────────────────────────────────┐
│              导航栏                      │
├─────────────────────────────────────────┤
│  统计卡片区域                            │
├─────────────────────────────────────────┤
│                                        │
│              主内容区域                  │
│                                        │
└─────────────────────────────────────────┘
```

### 导航栏

- **系统标题**：显示"问卷管理系统"
- **导航菜单**：
  - 仪表板：系统概览和统计信息
  - 问卷管理：问卷数据管理功能
  - 操作日志：查看系统操作记录
- **用户菜单**：
  - 当前用户信息
  - 退出登录

### 统计卡片

仪表板顶部显示关键统计信息：

- **总问卷数**：系统中所有问卷的总数量
- **今日新增**：当天新提交的问卷数量
- **本周新增**：本周新提交的问卷数量
- **本月新增**：本月新提交的问卷数量

### 主内容区域

根据当前选择的功能显示相应内容：
- 问卷列表表格
- 详细信息面板
- 操作日志列表
- 系统设置界面

## 问卷数据管理

### 问卷列表

问卷列表以表格形式显示所有问卷数据：

| 列名 | 说明 |
|------|------|
| 选择框 | 用于批量操作的复选框 |
| ID | 问卷的唯一标识符 |
| 姓名 | 填写问卷的人员姓名 |
| 年级 | 填写人员的年级信息 |
| 类型 | 问卷类型（如：小学生交流评定表） |
| 提交时间 | 问卷提交的日期和时间 |
| 操作 | 可执行的操作按钮 |

### 查看问卷详情

1. **点击查看按钮**
   - 在问卷列表中点击"查看"按钮
   - 系统会打开问卷详情页面

2. **详情页面内容**
   - **基本信息**：姓名、年级、提交时间等
   - **问题和答案**：完整的问卷内容
   - **统计信息**：得分、完成率等（如适用）

3. **详情页面操作**
   - **编辑**：修改问卷数据
   - **删除**：删除当前问卷
   - **导出**：导出单个问卷数据
   - **返回**：返回问卷列表

### 编辑问卷数据

1. **进入编辑模式**
   - 在详情页面点击"编辑"按钮
   - 或在列表中直接点击"编辑"按钮

2. **编辑内容**
   - **基本信息**：可修改姓名、年级等基本信息
   - **答案内容**：可修改问题的答案
   - **提交时间**：可调整提交时间（如需要）

3. **保存更改**
   - 点击"保存"按钮提交更改
   - 系统会验证数据格式
   - 保存成功后显示确认消息

4. **取消编辑**
   - 点击"取消"按钮放弃更改
   - 系统会返回到查看模式

### 删除问卷

1. **单个删除**
   - 在问卷列表或详情页面点击"删除"按钮
   - 系统会显示确认对话框
   - 确认后问卷将被永久删除

2. **删除确认**
   - 确认对话框会显示要删除的问卷信息
   - 点击"确认删除"执行删除操作
   - 点击"取消"放弃删除操作

3. **删除结果**
   - 删除成功后显示成功消息
   - 问卷列表会自动刷新
   - 删除操作会被记录在操作日志中

## 批量操作

### 选择问卷

1. **全选功能**
   - 点击表头的复选框可选择/取消选择所有问卷
   - 全选状态会显示在复选框中

2. **单选功能**
   - 点击每行的复选框选择单个问卷
   - 可以选择多个问卷进行批量操作

3. **选择状态**
   - 已选择的问卷行会高亮显示
   - 页面顶部会显示已选择的问卷数量

### 批量删除

1. **启动批量删除**
   - 选择要删除的问卷
   - 点击"批量删除"按钮

2. **确认删除**
   - 系统会显示确认对话框
   - 对话框中列出将要删除的问卷数量
   - 显示部分问卷的详细信息供确认

3. **执行删除**
   - 点击"确认删除"执行批量删除
   - 系统会显示删除进度
   - 完成后显示删除结果统计

4. **删除结果**
   - 显示成功删除的问卷数量
   - 如有失败，会显示失败原因
   - 问卷列表自动刷新

### 批量导出

1. **选择导出问卷**
   - 选择要导出的问卷
   - 点击"批量导出"按钮

2. **选择导出格式**
   - CSV 格式：适合数据分析
   - Excel 格式：适合办公使用
   - PDF 格式：适合打印和存档

3. **导出设置**
   - 选择要包含的字段
   - 设置文件名（可选）
   - 选择导出范围

4. **下载文件**
   - 系统生成导出文件
   - 自动开始下载
   - 导出操作会被记录在日志中

## 数据导出

### 导出格式

#### CSV 格式
- **用途**：数据分析、导入其他系统
- **特点**：纯文本格式，兼容性好
- **内容**：包含所有问卷数据和答案

#### Excel 格式
- **用途**：办公使用、数据处理
- **特点**：支持格式化、公式计算
- **内容**：多个工作表，分别包含基本信息和详细答案

#### PDF 格式
- **用途**：打印、存档、报告
- **特点**：格式固定，适合阅读
- **内容**：格式化的问卷报告

### 导出操作

1. **单个导出**
   - 在问卷详情页面选择导出格式
   - 点击相应的导出按钮
   - 文件会自动下载

2. **批量导出**
   - 在问卷列表中选择多个问卷
   - 点击"批量导出"按钮
   - 选择导出格式和设置

3. **全部导出**
   - 使用搜索功能筛选需要的问卷
   - 全选当前页面或所有搜索结果
   - 执行批量导出

### 导出文件命名

导出文件采用以下命名规则：
- 单个问卷：`questionnaire_{姓名}_{日期}.{格式}`
- 批量导出：`questionnaires_export_{时间戳}.{格式}`
- 全部导出：`all_questionnaires_{日期}.{格式}`

## 搜索和筛选

### 基本搜索

1. **搜索框使用**
   - 在页面顶部的搜索框中输入关键词
   - 支持搜索姓名、年级、问卷类型
   - 按回车键或点击搜索按钮执行搜索

2. **搜索结果**
   - 匹配的问卷会在列表中高亮显示
   - 页面显示搜索结果数量
   - 可以清除搜索条件返回完整列表

### 高级筛选

1. **按类型筛选**
   - 点击"类型"下拉菜单
   - 选择特定的问卷类型
   - 列表会自动更新显示筛选结果

2. **按年级筛选**
   - 点击"年级"下拉菜单
   - 选择特定年级
   - 支持多选年级

3. **按日期筛选**
   - 设置开始日期和结束日期
   - 筛选指定时间范围内的问卷
   - 支持快捷日期选择（今天、本周、本月）

4. **组合筛选**
   - 可以同时使用多个筛选条件
   - 筛选条件之间是"与"的关系
   - 清除筛选可以重置所有条件

### 排序功能

1. **点击列标题排序**
   - 点击表格列标题可以按该列排序
   - 再次点击可以切换升序/降序
   - 当前排序列会显示排序指示器

2. **支持排序的列**
   - ID：按问卷编号排序
   - 姓名：按姓名字母顺序排序
   - 年级：按年级排序
   - 提交时间：按时间先后排序

## 分页功能

### 分页控件

页面底部显示分页控件：
- **页码按钮**：直接跳转到指定页面
- **上一页/下一页**：逐页浏览
- **首页/末页**：快速跳转到第一页或最后一页
- **页面信息**：显示当前页码和总页数

### 每页显示数量

- **默认设置**：每页显示 20 条记录
- **可选数量**：10、20、50、100 条记录
- **自动调整**：根据屏幕大小自动调整显示数量

## 系统监控

### 系统状态

1. **访问监控页面**
   - 在导航菜单中点击"系统状态"
   - 或访问 `/api/admin/system/status`

2. **监控指标**
   - **CPU 使用率**：当前 CPU 使用百分比
   - **内存使用率**：当前内存使用情况
   - **磁盘空间**：可用磁盘空间
   - **数据库状态**：数据库连接和记录数量

3. **健康检查**
   - 系统会定期进行健康检查
   - 异常情况会显示警告信息
   - 可以手动触发健康检查

### 性能监控

1. **响应时间**
   - 监控 API 接口响应时间
   - 显示平均响应时间和最大响应时间
   - 识别性能瓶颈

2. **请求统计**
   - 统计每小时/每天的请求数量
   - 分析访问模式和高峰时段
   - 监控错误率

3. **资源使用**
   - 监控服务器资源使用情况
   - 预警资源不足的情况
   - 提供优化建议

### 警告和通知

1. **系统警告**
   - 磁盘空间不足警告
   - 内存使用过高警告
   - 数据库连接异常警告

2. **通知方式**
   - 页面内通知：在管理界面显示警告信息
   - 日志记录：所有警告都会记录在系统日志中
   - 邮件通知：重要警告可以发送邮件（如已配置）

## 操作日志

### 查看操作日志

1. **访问日志页面**
   - 在导航菜单中点击"操作日志"
   - 系统会显示最近的操作记录

2. **日志内容**
   - **操作时间**：操作发生的具体时间
   - **操作用户**：执行操作的用户名
   - **操作类型**：具体的操作类型（登录、删除、导出等）
   - **操作对象**：操作涉及的问卷或系统对象
   - **操作详情**：操作的详细描述
   - **IP 地址**：操作来源的 IP 地址

### 日志筛选

1. **按时间筛选**
   - 选择开始时间和结束时间
   - 查看指定时间范围内的操作

2. **按用户筛选**
   - 选择特定用户
   - 查看该用户的所有操作记录

3. **按操作类型筛选**
   - 选择操作类型（登录、删除、导出等）
   - 查看特定类型的操作记录

### 日志导出

1. **导出操作日志**
   - 选择要导出的日志记录
   - 点击"导出日志"按钮
   - 选择导出格式（CSV 或 Excel）

2. **审计报告**
   - 生成指定时间段的审计报告
   - 包含所有关键操作的统计信息
   - 适合合规性检查和安全审计

## 用户管理

### 查看用户列表

1. **访问用户管理**
   - 在系统设置中选择"用户管理"
   - 显示所有系统用户列表

2. **用户信息**
   - **用户名**：登录用户名
   - **角色**：用户角色（管理员、普通用户等）
   - **创建时间**：账户创建时间
   - **最后登录**：最近一次登录时间
   - **状态**：账户状态（活跃、禁用等）

### 创建新用户

1. **添加用户**
   - 点击"添加用户"按钮
   - 填写用户信息表单

2. **用户信息设置**
   - **用户名**：设置登录用户名（唯一）
   - **密码**：设置初始密码
   - **角色**：选择用户角色
   - **邮箱**：设置用户邮箱（可选）

3. **保存用户**
   - 点击"保存"按钮创建用户
   - 系统会验证用户名的唯一性
   - 创建成功后显示确认信息

### 编辑用户

1. **修改用户信息**
   - 在用户列表中点击"编辑"按钮
   - 修改用户的基本信息

2. **重置密码**
   - 点击"重置密码"按钮
   - 设置新的密码
   - 用户下次登录时需要使用新密码

3. **更改角色**
   - 修改用户的角色权限
   - 保存后立即生效

### 禁用/启用用户

1. **禁用用户**
   - 点击用户操作中的"禁用"按钮
   - 禁用后用户无法登录系统
   - 用户的会话会立即失效

2. **启用用户**
   - 点击"启用"按钮重新激活用户
   - 用户可以正常登录系统

## 系统设置

### 基本设置

1. **系统信息**
   - **系统名称**：自定义系统显示名称
   - **系统描述**：系统的简要描述
   - **联系信息**：管理员联系方式

2. **会话设置**
   - **会话超时时间**：设置用户会话的超时时间
   - **自动登出**：启用/禁用自动登出功能
   - **并发登录**：是否允许同一用户多处登录

### 数据设置

1. **数据保留**
   - **数据保留期限**：设置问卷数据的保留时间
   - **自动清理**：启用自动清理过期数据
   - **清理通知**：数据清理前的通知设置

2. **备份设置**
   - **自动备份**：启用/禁用自动备份功能
   - **备份频率**：设置备份的频率（每日、每周等）
   - **备份保留**：设置备份文件的保留数量

### 安全设置

1. **密码策略**
   - **密码长度**：设置最小密码长度
   - **密码复杂度**：要求包含大小写字母、数字、特殊字符
   - **密码有效期**：设置密码的有效期

2. **登录安全**
   - **登录尝试限制**：设置登录失败次数限制
   - **账户锁定时间**：设置账户锁定的时间
   - **IP 白名单**：设置允许访问的 IP 地址范围

### 通知设置

1. **邮件通知**
   - **SMTP 服务器**：配置邮件服务器信息
   - **发件人地址**：设置系统邮件的发件人
   - **通知类型**：选择需要邮件通知的事件

2. **系统通知**
   - **警告通知**：系统异常时的通知设置
   - **操作通知**：重要操作的通知设置
   - **定期报告**：定期发送系统使用报告

## 故障排除

### 常见问题

#### 1. 无法登录系统

**问题描述**：输入正确的用户名和密码后无法登录

**可能原因**：
- 用户账户被禁用
- 密码已过期
- 会话配置问题
- 网络连接问题

**解决方法**：
1. 检查用户账户状态
2. 重置用户密码
3. 清除浏览器缓存和 Cookie
4. 检查网络连接
5. 查看系统日志获取详细错误信息

#### 2. 页面加载缓慢

**问题描述**：管理后台页面加载速度很慢

**可能原因**：
- 数据量过大
- 服务器资源不足
- 网络带宽限制
- 数据库性能问题

**解决方法**：
1. 使用分页功能减少单页数据量
2. 使用筛选功能缩小数据范围
3. 检查服务器资源使用情况
4. 优化数据库查询
5. 清理不必要的数据

#### 3. 导出功能失败

**问题描述**：点击导出按钮后没有反应或出现错误

**可能原因**：
- 选择的数据量过大
- 磁盘空间不足
- 权限问题
- 浏览器兼容性问题

**解决方法**：
1. 减少导出的数据量
2. 检查服务器磁盘空间
3. 检查文件权限设置
4. 尝试使用不同的浏览器
5. 分批导出大量数据

#### 4. 搜索功能异常

**问题描述**：搜索功能返回错误的结果或无结果

**可能原因**：
- 搜索关键词格式问题
- 数据库索引问题
- 搜索逻辑错误

**解决方法**：
1. 检查搜索关键词的格式
2. 尝试使用不同的搜索条件
3. 清除搜索条件后重新搜索
4. 联系技术支持检查数据库状态

### 错误代码说明

| 错误代码 | 说明 | 解决方法 |
|----------|------|----------|
| 401 | 未授权访问 | 重新登录系统 |
| 403 | 权限不足 | 联系管理员获取权限 |
| 404 | 页面不存在 | 检查 URL 地址是否正确 |
| 500 | 服务器内部错误 | 联系技术支持 |
| 503 | 服务不可用 | 稍后重试或联系技术支持 |

### 联系技术支持

如果遇到无法解决的问题，请联系技术支持：

1. **收集信息**：
   - 错误发生的具体时间
   - 执行的操作步骤
   - 错误信息截图
   - 浏览器类型和版本

2. **联系方式**：
   - 邮箱：support@example.com
   - 电话：400-xxx-xxxx
   - 在线客服：系统内置客服功能

3. **紧急情况**：
   - 系统完全无法访问
   - 数据丢失或损坏
   - 安全相关问题

请优先使用邮箱联系，并详细描述问题情况。技术支持团队会在 24 小时内回复。

---

**版本信息**：本手册适用于问卷数据管理系统 v1.0 及以上版本。如有更新，请及时下载最新版本的使用手册。